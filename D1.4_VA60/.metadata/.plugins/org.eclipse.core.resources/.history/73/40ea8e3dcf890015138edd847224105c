/*
 * TCPclient.h
 *
 *  Created on: 2015Äê11ÔÂ4ÈÕ
 *      Author: Administrator
 */
#ifndef APP_USER_TCPCLIENT_H_
#define APP_USER_TCPCLIENT_H_

#define SENSOR_DATA_NUM 20
#define SENSOR_DATA_MEM_ADDR 120
#define INIT_MAGIC 0x7e7e55a5

#define RTC_CNT_ADDR 120
#define DSLEEP_TIME SENSOR_DEEP_SLEEP_TIME
#define SENSOR_DATA_SET_LEN      50 // max LEN OF STR LIKE :  {"x":1,"y":351}
#define SENSOR_DATA_STREAM "supply-voltage"  //in accord with the data-point name on the server
#define    __SET__DEEP_SLEEP__WAKEUP_NO_RF__    system_deep_sleep_set_option(4)
#define    __SET__DEEP_SLEEP__WAKEUP_NORMAL__	system_deep_sleep_set_option(1)


typedef struct{
	uint32 init_flg;
	uint16 cnt;
	uint16 wifi_config;
	uint16 data[SENSOR_DATA_NUM];
}SENSOR_DATA_RTC_MEM;

struct VA_saved_param{

	uint32 	init_flag;
	uint32 	param_interval;
	char 	param_ap_ssid[64];
	char 	param_ap_psw[64];
	char    param_my_ssid[64];//8266 ssid
	char		param_my_psw[64];//8266 psw
	char 	param_SN[10];		//lewei SN
	char		param_nc[2];

};

LOCAL void ICACHE_FLASH_ATTR 	data_func() ;



void 	user_tcp_connect(void);
LOCAL void ICACHE_FLASH_ATTR 	user_tcp_connect_cb(void *arg);
LOCAL void ICACHE_FLASH_ATTR 	user_tcp_recon_cb(void *arg, sint8 err);
LOCAL void ICACHE_FLASH_ATTR 	user_tcp_recv_cb(void *arg, char *pusrdata, unsigned short length);
LOCAL void ICACHE_FLASH_ATTR	user_tcp_sent_cb(void *arg);
LOCAL void ICACHE_FLASH_ATTR	user_tcp_discon_cb(void *arg);
LOCAL void ICACHE_FLASH_ATTR	user_sent_data(struct espconn *pespconn);

LOCAL void ICACHE_FLASH_ATTR	interval_timer_cb();




#endif /* APP_USER_TCPCLIENT_H_ */
